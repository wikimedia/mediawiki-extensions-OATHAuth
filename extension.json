{
	"name": "OATHAuth",
	"author": [
		"Ryan Lane",
		"Robert Vogel <vogel@hallowelt.com>",
		"Dejan Savuljesku <savuljesku@hallowelt.com>",
		"Taavi Väänänen"
	],
	"url": "https://www.mediawiki.org/wiki/Extension:OATHAuth",
	"descriptionmsg": "oathauth-desc",
	"type": "other",
	"requires": {
		"MediaWiki": ">= 1.46"
	},
	"license-name": "GPL-2.0-or-later AND GPL-3.0-or-later",
	"attributes": {
		"Echo": {
			"Notifications": {
				"oathauth-disable": {
					"category": "system",
					"group": "negative",
					"section": "alert",
					"presentation-model": "MediaWiki\\Extension\\OATHAuth\\Notifications\\DisablePresentationModel",
					"canNotifyAgent": true,
					"user-locators": [
						"MediaWiki\\Extension\\Notifications\\UserLocator::locateEventAgent"
					]
				},
				"oathauth-enable": {
					"category": "system",
					"group": "positive",
					"section": "alert",
					"presentation-model": "MediaWiki\\Extension\\OATHAuth\\Notifications\\EnablePresentationModel",
					"canNotifyAgent": true,
					"user-locators": [
						"MediaWiki\\Extension\\Notifications\\UserLocator::locateEventAgent"
					]
				},
				"oathauth-recoverycodes-count": {
					"category": "system",
					"group": "negative",
					"section": "alert",
					"presentation-model": "MediaWiki\\Extension\\OATHAuth\\Notifications\\RecoveryCodeCountPresentationModel",
					"canNotifyAgent": true,
					"user-locators": [
						"MediaWiki\\Extension\\Notifications\\UserLocator::locateEventAgent"
					]
				}
			}
		},
		"OATHAuth": {
			"Modules": {
				"recoverycodes": {
					"class": "\\MediaWiki\\Extension\\OATHAuth\\Module\\RecoveryCodes",
					"services": [
						"OATHUserRepository"
					]
				},
				"totp": {
					"class": "\\MediaWiki\\Extension\\OATHAuth\\Module\\TOTP",
					"services": [
						"OATHUserRepository"
					]
				},
				"webauthn": "MediaWiki\\Extension\\OATHAuth\\Module\\WebAuthn::factory"
			}
		}
	},
	"AutoloadNamespaces": {
		"MediaWiki\\Extension\\OATHAuth\\": "src/",
		"MediaWiki\\Extension\\OATHAuth\\Maintenance\\": "maintenance/"
	},
	"TestAutoloadNamespaces": {
		"MediaWiki\\Extension\\OATHAuth\\Tests\\Integration\\": "tests/phpunit/integration/",
		"MediaWiki\\Extension\\OATHAuth\\Tests\\Unit\\": "tests/phpunit/unit/"
	},
	"AuthManagerAutoConfig": {
		"secondaryauth": {
			"OATHSecondaryAuthenticationProvider": {
				"class": "\\MediaWiki\\Extension\\OATHAuth\\Auth\\SecondaryAuthenticationProvider",
				"sort": 50
			}
		}
	},
	"ServiceWiringFiles": [
		"ServiceWiring.php"
	],
	"ExtensionMessagesFiles": {
		"OATHAuthAlias": "OATHAuth.alias.php"
	},
	"Hooks": {
		"AuthChangeFormFields": "main",
		"GetPreferences": "main",
		"getUserPermissionsErrors": "main",
		"LoadExtensionSchemaUpdates": "updater",
		"ResourceLoaderGetConfigVars": "main",
		"UserEffectiveGroups": "main",
		"UserGetRights": "main",
		"UserRequirementsCondition": "main",
		"UnitTestsAfterDatabaseSetup": "test",
		"UnitTestsBeforeDatabaseTeardown": "test"
	},
	"HookHandlers": {
		"main": {
			"class": "\\MediaWiki\\Extension\\OATHAuth\\Hook\\HookHandler",
			"services": [
				"OATHUserRepository",
				"OATHAuthModuleRegistry",
				"PermissionManager",
				"MainConfig",
				"UserGroupManager"
			]
		},
		"updater": {
			"class": "MediaWiki\\Extension\\OATHAuth\\Hook\\UpdateTables"
		},
		"test": {
			"class": "MediaWiki\\Extension\\OATHAuth\\Hook\\TestHandler",
			"services": [
				"DBLoadBalancer"
			]
		}
	},
	"MessagesDirs": {
		"OATHAuth": [
			"i18n",
			"i18n/api"
		],
		"WebAuthn": [
			"i18n/webauthn",
			"i18n/webauthn/api"
		]
	},
	"callback": "MediaWiki\\Extension\\OATHAuth\\Hook\\RegistrationCallback::onRegistration",
	"config": {
		"OATHAuthWindowRadius": {
			"value": 4,
			"description": "Number of token windows on either side of current time to be considered valid for authentication."
		},
		"OATHAuthAccountPrefix": {
			"value": false,
			"description": "Prefix for user account shown during enrollment."
		},
		"OATHExclusiveRights": {
			"value": [],
			"description": "List of permissions that are revoked from users who do not use two-factor authentication."
		},
		"OATHRequiredForGroups": {
			"value": [],
			"description": "List of user groups that must use two-factor authentication."
		},
		"OATHSecretKey": {
			"value": false,
			"description": "A secret key value for encrypting OATH-related data which should be SODIUM_CRYPTO_SECRETBOX_KEYBYTES hexadecimal bytes (64 chars) in length. This variable is currently considered immutable. Do not publicly set this value."
		},
		"OATHPrioritizedModules": {
			"value": [ "webauthn", "totp", "recoverycodes" ],
			"description": "List of authentication methods in the order that they should be prioritized."
		},
		"OATHRecoveryCodesCount": {
			"value": 10,
			"description": "The default amount of recovery codes to generate for a given user."
		},
		"OATHMaxKeysPerUser": {
			"value": 100,
			"description": "Maximum amount of keys allowed per user."
		},
		"OATHNewPasskeyFeatures": {
			"value": false,
			"description": "Temporary feature flag for the new passkey features (T410332)."
		},
		"WebAuthnRelyingPartyName": {
			"value": null
		},
		"WebAuthnRelyingPartyID": {
			"value": null
		},
		"WebAuthnNewCredsDisabled": {
			"description": "If true, new credentials cannot be added, see T354701",
			"value": false
		},
		"WebAuthnLimitPasskeysToRoaming": {
			"description": "Temporary option to limit passkeys to roaming until better passkey support is added",
			"value": true
		}
	},
	"ResourceModules": {
		"ext.oath.totpenable.styles": {
			"class": "MediaWiki\\ResourceLoader\\CodexModule",
			"styles": [
				"totp/ext.oath.showqrcode.styles.less"
			],
			"codexStyleOnly": true,
			"codexComponents": [
				"CdxButton",
				"CdxIcon"
			]
		},
		"ext.oath.recovery.styles": {
			"class": "MediaWiki\\ResourceLoader\\CodexModule",
			"styles": [
				"recovery/ext.oath.recovery.less"
			],
			"codexStyleOnly": true,
			"codexComponents": [
				"CdxButton",
				"CdxIcon"
			]
		},
		"ext.oath.recovery": {
			"packageFiles": [
				"recovery/ext.oath.recovery.copy.js"
			],
			"messages": [
				"oathauth-recoverycodes-copy-success"
			]
		},
		"ext.oath.manage": {
			"class": "MediaWiki\\ResourceLoader\\CodexModule",
			"localBasePath": "modules/oathmanage",
			"remoteExtPath": "OATHAuth/modules/oathmanage",
			"packageFiles": [
				"init.js",
				"AddPasskeyButton.vue",
				"AddPasskeyDialog.vue",
				{
					"name": "data.json",
					"callback": "MediaWiki\\Extension\\OATHAuth\\Hook\\HookHandler::getOathManageModuleData"
				}
			],
			"codexComponents": [
				"CdxButton",
				"CdxDialog",
				"CdxMessage",
				"useModelWrapper"
			],
			"messages": [
				"oathauth-passkeys-add",
				"oathauth-passkey-dialog-title",
				"oathauth-passkey-dialog-text",
				"oathauth-passkey-dialog-back",
				"oathauth-passkey-dialog-add"
			]
		},
		"ext.oath.manage.styles": {
			"class": "MediaWiki\\ResourceLoader\\CodexModule",
			"styles": [
				"oathmanage/oathmanage.less"
			],
			"codexStyleOnly": true,
			"codexComponents": [
				"CdxMessage",
				"CdxButton",
				"CdxAccordion",
				"CdxField",
				"CdxLabel",
				"CdxTextInput"
			]
		},
		"ext.webauthn.ui.base": {
			"scripts": [
				"webauthn/util/util.js",
				"webauthn/ui/CredentialForm.js"
			],
			"dependencies": [
				"ext.webauthn.ui.base.styles",
				"oojs-ui",
				"mediawiki.jqueryMsg"
			],
			"messages": [
				"webauthn-error-browser-unsupported",
				"webauthn-error-browser-unsupported-console",
				"webauthn-ui-reload-page-label"
			]
		},
		"ext.webauthn.ui.base.styles": {
			"styles": [
				"webauthn/stylesheets/ui.base.styles.less"
			]
		},
		"ext.webauthn.Registrator": {
			"scripts": [
				"webauthn/util/Registrator.js"
			],
			"dependencies": [
				"ext.webauthn.ui.base"
			],
			"messages": [
				"webauthn-error-get-reginfo-fail",
				"webauthn-error-reg-generic"
			]
		},
		"ext.webauthn.register": {
			"scripts": [
				"webauthn/ui/RegisterForm.js",
				"webauthn/register.js"
			],
			"dependencies": [
				"mediawiki.api",
				"mediawiki.util",
				"ext.webauthn.ui.base",
				"ext.webauthn.Registrator"
			]
		},
		"ext.webauthn.login": {
			"scripts": [
				"webauthn/util/Authenticator.js",
				"webauthn/ui/LoginForm.js",
				"webauthn/login.js"
			],
			"dependencies": [
				"ext.webauthn.ui.base"
			],
			"messages": [
				"webauthn-error-get-authinfo-fail",
				"webauthn-error-auth-generic"
			]
		},
		"ext.webauthn.manage": {
			"scripts": [
				"webauthn/util/Authenticator.js",
				"webauthn/ui/ManageForm.js",
				"webauthn/manage.js"
			],
			"styles": [
				"webauthn/stylesheets/manage.styles.less"
			],
			"dependencies": [
				"mediawiki.api",
				"ext.webauthn.ui.base"
			],
			"messages": [
				"webauthn-error-get-authinfo-fail",
				"webauthn-error-auth-generic"
			]
		}
	},
	"ResourceFileModulePaths": {
		"localBasePath": "modules",
		"remoteExtPath": "OATHAuth/modules"
	},
	"SpecialPages": {
		"DisableOATHForUser": {
			"class": "\\MediaWiki\\Extension\\OATHAuth\\Special\\DisableOATHForUser",
			"services": [
				"OATHUserRepository",
				"UserFactory",
				"CentralIdLookup",
				"ExtensionRegistry"
			]
		},
		"OATHManage": {
			"class": "\\MediaWiki\\Extension\\OATHAuth\\Special\\OATHManage",
			"services": [
				"OATHUserRepository",
				"OATHAuthModuleRegistry",
				"AuthManager",
				"UserGroupManager"
			]
		},
		"VerifyOATHForUser": {
			"class": "\\MediaWiki\\Extension\\OATHAuth\\Special\\VerifyOATHForUser",
			"services": [
				"OATHUserRepository",
				"UserFactory",
				"ExtensionRegistry"
			]
		}
	},
	"AvailableRights": [
		"oathauth-enable",
		"oathauth-api-all",
		"oathauth-disable-for-user",
		"oathauth-verify-user",
		"oathauth-view-log"
	],
	"GroupPermissions": {
		"*": {
			"oathauth-disable-for-user": false,
			"oathauth-view-log": false
		},
		"user": {
			"oathauth-enable": true
		},
		"sysop": {
			"oathauth-disable-for-user": true,
			"oathauth-verify-user": true,
			"oathauth-view-log": true
		}
	},
	"GrantPermissions": {
		"oath": {
			"oathauth-api-all": true,
			"oathauth-verify-user": true
		}
	},
	"GrantPermissionGroups": {
		"oath": "authentication"
	},
	"GrantRiskGroups": {
		"oath": "internal"
	},
	"APIModules": {
		"oathvalidate": {
			"class": "\\MediaWiki\\Extension\\OATHAuth\\Api\\Module\\ApiOATHValidate",
			"services": [
				"OATHUserRepository",
				"UserFactory"
			]
		},
		"webauthn": {
			"class": "\\MediaWiki\\Extension\\OATHAuth\\Api\\Module\\WebAuthn",
			"services": [
				"AuthManager"
			]
		}
	},
	"APIMetaModules": {
		"oath": {
			"class": "\\MediaWiki\\Extension\\OATHAuth\\Api\\Module\\ApiQueryOATH",
			"services": [
				"OATHUserRepository"
			]
		}
	},
	"RateLimits": {
		"badoath": {
			"&can-bypass": false,
			"user": [
				10,
				60
			],
			"user-global": [
				10,
				60
			]
		}
	},
	"load_composer_autoloader": true,
	"LogTypes": [
		"oath"
	],
	"LogNames": {
		"oath": "oath-log-name"
	},
	"LogHeaders": {
		"oath": "oath-log-header"
	},
	"LogActionsHandlers": {
		"oath/*": "LogFormatter"
	},
	"LogRestrictions": {
		"oath": "oathauth-view-log"
	},
	"ActionFilteredLogs": {
		"oath": {
			"verify": [
				"verify"
			],
			"disable-other": [
				"disable-other"
			]
		}
	},
	"DatabaseVirtualDomains": [
		"virtual-oathauth"
	],
	"manifest_version": 2
}
